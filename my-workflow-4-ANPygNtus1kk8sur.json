{"createdAt":"2025-08-22T04:54:28.318Z","updatedAt":"2025-08-25T14:05:42.000Z","id":"ANPygNtus1kk8sur","name":"My workflow 4","active":false,"isArchived":false,"nodes":[{"parameters":{"url":"https://Hindu-Panchang.proxy-production.allthingsdev.co/panchang","sendQuery":true,"queryParameters":{"parameters":[{"name":"date","value":"={{ $json.date }}-{{ $json.month }}-{{ $json.year }}"},{"name":"lat","value":"22.3000"},{"name":"lng","value":"73.2065"},{"name":"alt","value":"0.494"},{"name":"tz","value":"Asia/Kolkata"}]},"sendHeaders":true,"headerParameters":{"parameters":[{"name":"Accept","value":"application/json"},{"name":"x-apihub-key","value":"n2yQ8EezkIqczWrzXY04qj1rz8gjrVXAVMUlGnGaEEtAq7ElZ2"},{"name":"x-apihub-host","value":"Hindu-Panchang.allthingsdev.co"},{"name":"x-apihub-endpoint","value":"a925b172-7b98-4142-9348-c1524fe9abd4"}]},"options":{"redirect":{"redirect":{}}}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[-160,544],"id":"0ae79762-cb86-4018-aa84-ac9168b8faea","name":"HTTP Request"},{"parameters":{},"type":"n8n-nodes-base.manualTrigger","typeVersion":1,"position":[-640,576],"id":"3979bd06-37de-49ff-8bfa-e938010e7f56","name":"When clicking ‘Execute workflow’"},{"parameters":{"jsCode":"// Convert current UTC time to IST (+5:30)\nconst now = new Date();\n\n// Get IST offset in milliseconds (5.5 hours = 19800 seconds = 19800000 ms)\nconst istOffset = 5.5 * 60 * 60 * 1000;\n\n// Create new Date adjusted to IST\nconst istTime = new Date(now.getTime() + istOffset);\n\nreturn [\n  {\n    json: {\n      year: istTime.getFullYear(),\n      month: istTime.getMonth() + 1, // Month is 0-based\n      date: istTime.getDate(),\n      hours: istTime.getHours(),\n      minutes: istTime.getMinutes(),\n      seconds: istTime.getSeconds(),\n    }\n  }\n];\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-432,384],"id":"00182adf-7231-44b1-8d5d-cada09da21a5","name":"convert time to india"},{"parameters":{"jsCode":"const formatted = {};\n\nfor (const item of items) {\n  const name = item.json.name;\n  const start = new Date(item.json.starts_at);\n  const end = new Date(item.json.ends_at);\n\n  // Format time to hh:mm AM/PM\n  const formatTime = (date) => {\n    let hrs = date.getHours();\n    const mins = date.getMinutes().toString().padStart(2, '0');\n    const ampm = hrs >= 12 ? 'PM' : 'AM';\n    hrs = hrs % 12 || 12;\n    return `${hrs}:${mins} ${ampm}`;\n  };\n\n  if (!formatted[name]) {\n    formatted[name] = [];\n  }\n\n  formatted[name].push(`${formatTime(start)} - ${formatTime(end)}`);\n}\n\n// Now build separate entries\nconst output = [];\n\nfor (const [name, slots] of Object.entries(formatted)) {\n  slots.forEach((slot, index) => {\n    output.push({\n      json: {\n        slot: `${name} ${index + 1}`,\n        time: slot\n      }\n    });\n  });\n}\n\nreturn output;\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[400,544],"id":"8ac8550c-255f-46b5-84c5-87e5e8d358cf","name":"Code1"},{"parameters":{"method":"POST","url":"https://json.freeastrologyapi.com/choghadiya-timings","sendHeaders":true,"headerParameters":{"parameters":[{"name":"x-api-key","value":"ilIVkQl9rE2GS474OZieZ1O0mH5qfkDP8vFnwqKN"}]},"sendBody":true,"specifyBody":"json","jsonBody":"{\n  \"year\": 2025,\n  \"month\": 8,\n  \"date\": 6,\n  \"hours\": 19,\n  \"minutes\": 5,\n  \"seconds\": 0,\n  \"latitude\": 17.38333,\n  \"longitude\": 78.4666,\n  \"timezone\": 5.5,\n  \"config\": {\n    \"observation_point\": \"topocentric\",\n    \"ayanamsha\": \"lahiri\"\n  }\n}","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[-160,384],"id":"862b6155-0014-479d-ae65-8020f0ec26ee","name":"get all data"},{"parameters":{"jsCode":"const raw = items[0].json.output;\nconst parsed = JSON.parse(raw);\n\nconst desired = Object.values(parsed).filter(entry => \n  [\"Amrit\", \"Shubh\", \"Labh\"].includes(entry.name)\n);\n\nreturn desired.map(d => ({\n  json: d\n}));\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[64,384],"id":"9003c042-38ae-4bf6-bae4-33c21bcbd941","name":"filter labh shubh amrit"},{"parameters":{"content":"https://www.npmjs.com/package/n8n-nodes-canva#-pastas\n\nhttps://chatgpt.com/c/68930cf2-926c-8329-a848-b99229f86b65\n\nhttps://www.canva.com/design/DAGvTzYypu8/8bZHwh8JvNGRqOM08vGeYw/edit?ui=e30\n\nhttps://www.canva.dev/docs/connect/creating-integrations/\n\n\nhttps://www.allthingsdev.co/apimarketplace/endpoints/hindu-panchang/66b37cb3b7b7ad054eb3c542\n\nhttps://freeastrologyapi.com/api-reference/choghadiya-timings","height":272,"width":736},"type":"n8n-nodes-base.stickyNote","position":[-144,16],"typeVersion":1,"id":"e3e1885b-683b-45b7-aaa4-a460648cdda3","name":"Sticky Note"},{"parameters":{"promptType":"define","text":"=આજનું પંચાંગ: {{ $json.date }}/{{ $json.month }}/{{ $json.year }}\n\nનક્ષત્ર: {{ $json.nakshatra['Pūrvābhādrā'].end.time }} sudhi  {{ $json.nakshatra['Pūrvābhādrā'] }} pachhi {{ $json.nakshatra['Uttarābhādrā'] }}\n\nયોગ: {{ $json.yoga['Sukarmā'].end.time }} sudhi {{ $json.yoga['Sukarmā'] }} pachhi {{ $json.yoga['Dhṛti'] }}\n\nકરણ:{{ $json.karana['Viṣṭi'].end.time }} sudhi {{ $json.karana['Viṣṭi'] }} pachhi {{ $json.karana.Bava }}\n\nરાશિ:  {{ $json.lunarRaasi }} - {{ $json.lunarRaasi.Kumbham }}\n\n*સૂર્યોદય અને સૂર્યાસ્ત:*\n\nસૂર્યોદય: સવારે {{ $json.sunrise.time }}\n \nસૂર્યાસ્ત: સાંજે  {{ $json.sunset.time }}\n\nશુભ અને અશુભ સમય:\n\nરાહુ કાળ: બપોરે {{ $json.rahuKal.start.time }} thi {{ $json.rahuKal.end.time }} (આ સમયગાળામાં કોઈ પણ શુભ કાર્ય કરવું નહીં).\n\nઅભિજીત મુહૂર્ત: {{ $json.abhijit.start.time }} thi {{ $json.abhijit.end.time }} (આ સમય શુભ ગણાય છે).","options":{"systemMessage":"=You are a vedic astrologer and have to create a short post based on the data you are given.\nonly output in gujarati and dont fuck up.\nDont write any other words than the output itself.\nConvert all the data into proper gujarati readable format remove dates if excess and look like clutter"}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":2.1,"position":[-48,896],"id":"5ae85e74-9b15-4a24-8a07-66c858b32466","name":"AI Agent"},{"parameters":{"mode":"combine","combineBy":"combineByPosition","numberInputs":3,"options":{}},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[-400,848],"id":"85f7da6b-dd41-490a-9802-c54448b6d468","name":"Merge"},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatGoogleGemini","typeVersion":1,"position":[-32,1040],"id":"1b6205cd-5c29-413b-aefe-4e05cab91f36","name":"Google Gemini Chat Model","credentials":{"googlePalmApi":{"id":"elDw3vUBcK97sl4S","name":"Google Gemini(PaLM) Api account"}}}],"connections":{"HTTP Request":{"main":[[{"node":"Merge","type":"main","index":0}]]},"When clicking ‘Execute workflow’":{"main":[[{"node":"convert time to india","type":"main","index":0}]]},"convert time to india":{"main":[[{"node":"get all data","type":"main","index":0},{"node":"HTTP Request","type":"main","index":0},{"node":"Merge","type":"main","index":2}]]},"Code1":{"main":[[{"node":"Merge","type":"main","index":1}]]},"get all data":{"main":[[{"node":"filter labh shubh amrit","type":"main","index":0}]]},"filter labh shubh amrit":{"main":[[{"node":"Code1","type":"main","index":0}]]},"Merge":{"main":[[{"node":"AI Agent","type":"main","index":0}]]},"Google Gemini Chat Model":{"ai_languageModel":[[{"node":"AI Agent","type":"ai_languageModel","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"f3544737-682e-4185-8c04-b7a232e2c475","triggerCount":0,"tags":[]}